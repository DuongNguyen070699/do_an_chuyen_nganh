import { HttpParams } from '@angular/common/http';
import { RequestQueryBuilder } from './crud-request';
export class CrudBaseService {
    constructor(options, http) {
        this.http = http;
        this.options = options;
    }
    getPagination(limit, page, builder) {
        if (!builder) {
            builder = RequestQueryBuilder.create();
        }
        else if (!(builder instanceof RequestQueryBuilder)) {
            builder = RequestQueryBuilder.create(builder);
        }
        builder.setLimit(limit);
        builder.setPage(page);
        return this.http.get(this.getBaseUrl(), {
            params: this.getParamsFromQuery(builder),
        });
    }
    getMany(builder) {
        return this.http.get(this.getBaseUrl(), {
            params: this.getParamsFromQuery(builder),
        });
    }
    getOne(value, builder) {
        const url = this.getOneUrl(value);
        return this.http.get(url, {
            params: this.getParamsFromQuery(builder),
        });
    }
    create(body) {
        return this.http.post(this.getBaseUrl(), JSON.stringify(body), {
            headers: {
                'Content-Type': 'application/json',
            },
        });
    }
    createMany(body) {
        return this.http.post(this.getBaseUrl() + '/bulk', JSON.stringify({ bulk: body }), {
            headers: {
                'Content-Type': 'application/json',
            },
        });
    }
    put(value, body) {
        const url = this.getOneUrl(value);
        return this.http.put(url, JSON.stringify(body), {
            headers: {
                'Content-Type': 'application/json',
            },
        });
    }
    patch(value, body) {
        const url = this.getOneUrl(value);
        return this.http.patch(url, JSON.stringify(body), {
            headers: {
                'Content-Type': 'application/json',
            },
        });
    }
    delete(value) {
        const url = this.getOneUrl(value);
        return this.http.delete(url);
    }
    getParamsFromQuery(builder) {
        if (!(builder instanceof RequestQueryBuilder)) {
            builder = RequestQueryBuilder.create(builder);
        }
        return new HttpParams({ fromString: this.getQuery(builder) });
    }
    /**
     * Get request link
     */
    getBaseUrl() {
        return `${this.options.apiUrl}/${this.options.entity}`;
    }
    getOneUrl(value) {
        return `${this.getBaseUrl()}/${value}`;
    }
    getQuery(builder) {
        if (builder) {
            return builder.query();
        }
        return '';
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY3J1ZC1iYXNlLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZXN0LWNydWQtdHlwZW9ybS1jbGllbnQvIiwic291cmNlcyI6WyJsaWIvY3J1ZC1iYXNlLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFjLFVBQVUsRUFBRSxNQUFNLHNCQUFzQixDQUFDO0FBRTlELE9BQU8sRUFBcUIsbUJBQW1CLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQWV4RSxNQUFNLE9BQWdCLGVBQWU7SUFFbkMsWUFBWSxPQUF3QixFQUFZLElBQWdCO1FBQWhCLFNBQUksR0FBSixJQUFJLENBQVk7UUFDOUQsSUFBSSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7SUFDekIsQ0FBQztJQUVELGFBQWEsQ0FDWCxLQUFhLEVBQ2IsSUFBWSxFQUNaLE9BQWlEO1FBRWpELElBQUksQ0FBQyxPQUFPLEVBQUU7WUFDWixPQUFPLEdBQUcsbUJBQW1CLENBQUMsTUFBTSxFQUFFLENBQUM7U0FDeEM7YUFBTSxJQUFJLENBQUMsQ0FBQyxPQUFPLFlBQVksbUJBQW1CLENBQUMsRUFBRTtZQUNwRCxPQUFPLEdBQUcsbUJBQW1CLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQy9DO1FBQ0QsT0FBTyxDQUFDLFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUN4QixPQUFPLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3RCLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQXdCLElBQUksQ0FBQyxVQUFVLEVBQUUsRUFBRTtZQUM3RCxNQUFNLEVBQUUsSUFBSSxDQUFDLGtCQUFrQixDQUFDLE9BQU8sQ0FBQztTQUN6QyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsT0FBTyxDQUFDLE9BQWlEO1FBQ3ZELE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQU0sSUFBSSxDQUFDLFVBQVUsRUFBRSxFQUFFO1lBQzNDLE1B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QU8sT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO1NBQ3hCO1FBQ0QsT0FBTyxFQUFFLENBQUM7SUFDWixDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwUGFyYW1zIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xyXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XHJcbmltcG9ydCB7IENyZWF0ZVF1ZXJ5UGFyYW1zLCBSZXF1ZXN0UXVlcnlCdWlsZGVyIH0gZnJvbSAnLi9jcnVkLXJlcXVlc3QnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBDcnVkQmFzZU9wdGlvbnMge1xyXG4gIGVudGl0eTogc3RyaW5nO1xyXG4gIGFwaVVybDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJlc3BvbnNlUGFnaW5hdGlvbjxUPiB7XHJcbiAgZGF0YTogQXJyYXk8VD47XHJcbiAgY291bnQ6IG51bWJlcjtcclxuICB0b3RhbDogbnVtYmVyO1xyXG4gIHBhZ2U6IG51bWJlcjtcclxuICBwYWdlQ291bnQ6IG51bWJlcjtcclxufVxyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENydWRCYXNlU2VydmljZTxUPiB7XHJcbiAgcHJvdGVjdGVkIG9wdGlvbnM6IENydWRCYXNlT3B0aW9ucztcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBDcnVkQmFzZU9wdGlvbnMsIHByb3RlY3RlZCBodHRwOiBIdHRwQ2xpZW50KSB7XHJcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gIH1cclxuXHJcbiAgZ2V0UGFnaW5hdGlvbihcclxuICAgIGxpbWl0OiBudW1iZXIsXHJcbiAgICBwYWdlOiBudW1iZXIsXHJcbiAgICBidWlsZGVyPzogUmVxdWVzdFF1ZXJ5QnVpbGRlciB8IENyZWF0ZVF1ZXJ5UGFyYW1zXHJcbiAgKTogT2JzZXJ2YWJsZTxSZXNwb25zZVBhZ2luYXRpb248VD4+IHtcclxuICAgIGlmICghYnVpbGRlcikge1xyXG4gICAgICBidWlsZGVyID0gUmVxdWVzdFF1ZXJ5QnVpbGRlci5jcmVhdGUoKTtcclxuICAgIH0gZWxzZSBpZiAoIShidWlsZGVyIGluc3RhbmNlb2YgUmVxdWVzdFF1ZXJ5QnVpbGRlcikpIHtcclxuICAgICAgYnVpbGRlciA9IFJlcXVlc3RRdWVyeUJ1aWxkZXIuY3JlYXRlKGJ1aWxkZXIpO1xyXG4gICAgfVxyXG4gICAgYnVpbGRlci5zZXRMaW1pdChsaW1pdCk7XHJcbiAgICBidWlsZGVyLnNldFBhZ2UocGFnZSk7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxSZXNwb25zZVBhZ2luYXRpb248VD4+KHRoaXMuZ2V0QmFzZVVybCgpLCB7XHJcbiAgICAgIHBhcmFtczogdGhpcy5nZXRQYXJhbXNGcm9tUXVlcnkoYnVpbGRlciksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldE1hbnkoYnVpbGRlcj86IFJlcXVlc3RRdWVyeUJ1aWxkZXIgfCBDcmVhdGVRdWVyeVBhcmFtcyk6IE9ic2VydmFibGU8VFtdPiB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldDxUW10+KHRoaXMuZ2V0QmFzZVVybCgpLCB7XHJcbiAgICAgIHBhcmFtczogdGhpcy5nZXRQYXJhbXNGcm9tUXVlcnkoYnVpbGRlciksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldE9uZShcclxuICAgIHZhbHVlOiBudW1iZXIgfCBzdHJpbmcgfCBib29sZWFuLFxyXG4gICAgYnVpbGRlcj86IFJlcXVlc3RRdWVyeUJ1aWxkZXIgfCBDcmVhdGVRdWVyeVBhcmFtc1xyXG4gICk6IE9ic2VydmFibGU8VD4ge1xyXG4gICAgY29uc3QgdXJsID0gdGhpcy5nZXRPbmVVcmwodmFsdWUpO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8VD4odXJsLCB7XHJcbiAgICAgIHBhcmFtczogdGhpcy5nZXRQYXJhbXNGcm9tUXVlcnkoYnVpbGRlciksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGNyZWF0ZShib2R5OiBUKTogT2JzZXJ2YWJsZTxUPiB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8VD4odGhpcy5nZXRCYXNlVXJsKCksIEpTT04uc3RyaW5naWZ5KGJvZHkpLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjcmVhdGVNYW55KGJvZHk6IFRbXSk6IE9ic2VydmFibGU8VFtdPiB7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3Q8VFtdPihcclxuICAgICAgdGhpcy5nZXRCYXNlVXJsKCkgKyAnL2J1bGsnLFxyXG4gICAgICBKU09OLnN0cmluZ2lmeSh7IGJ1bGs6IGJvZHkgfSksXHJcbiAgICAgIHtcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBwdXQodmFsdWU6IG51bWJlciB8IHN0cmluZyB8IGJvb2xlYW4sIGJvZHk6IFQpOiBPYnNlcnZhYmxlPFQ+IHtcclxuICAgIGNvbnN0IHVybCA9IHRoaXMuZ2V0T25lVXJsKHZhbHVlKTtcclxuICAgIHJldHVybiB0aGlzLmh0dHAucHV0PFQ+KHVybCwgSlNPTi5zdHJpbmdpZnkoYm9keSksIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHBhdGNoKHZhbHVlOiBudW1iZXIgfCBzdHJpbmcgfCBib29sZWFuLCBib2R5OiBUKTogT2JzZXJ2YWJsZTxUPiB7XHJcbiAgICBjb25zdCB1cmwgPSB0aGlzLmdldE9uZVVybCh2YWx1ZSk7XHJcbiAgICByZXR1cm4gdGhpcy5odHRwLnBhdGNoPFQ+KHVybCwgSlNPTi5zdHJpbmdpZnkoYm9keSksIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgIH0sXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZSh2YWx1ZTogbnVtYmVyIHwgc3RyaW5nIHwgYm9vbGVhbik6IE9ic2VydmFibGU8dm9pZD4ge1xyXG4gICAgY29uc3QgdXJsID0gdGhpcy5nZXRPbmVVcmwodmFsdWUpO1xyXG4gICAgcmV0dXJuIHRoaXMuaHR0cC5kZWxldGU8dm9pZD4odXJsKTtcclxuICB9XHJcblxyXG4gIHByb3RlY3RlZCBnZXRQYXJhbXNGcm9tUXVlcnkoXHJcbiAgICBidWlsZGVyOiBSZXF1ZXN0UXVlcnlCdWlsZGVyIHwgQ3JlYXRlUXVlcnlQYXJhbXNcclxuICApIHtcclxuICAgIGlmICghKGJ1aWxkZXIgaW5zdGFuY2VvZiBSZXF1ZXN0UXVlcnlCdWlsZGVyKSkge1xyXG4gICAgICBidWlsZGVyID0gUmVxdWVzdFF1ZXJ5QnVpbGRlci5jcmVhdGUoYnVpbGRlcik7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbmV3IEh0dHBQYXJhbXMoeyBmcm9tU3RyaW5nOiB0aGlzLmdldFF1ZXJ5KGJ1aWxkZXIpIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IHJlcXVlc3QgbGlua1xyXG4gICAqL1xyXG4gIHByb3RlY3RlZCBnZXRCYXNlVXJsKCk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gYCR7dGhpcy5vcHRpb25zLmFwaVVybH0vJHt0aGlzLm9wdGlvbnMuZW50aXR5fWA7XHJcbiAgfVxyXG5cclxuICBwcm90ZWN0ZWQgZ2V0T25lVXJsKHZhbHVlOiBudW1iZXIgfCBzdHJpbmcgfCBib29sZWFuKSB7XHJcbiAgICByZXR1cm4gYCR7dGhpcy5nZXRCYXNlVXJsKCl9LyR7dmFsdWV9YDtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgZ2V0UXVlcnkoYnVpbGRlcj86IFJlcXVlc3RRdWVyeUJ1aWxkZXIpIHtcclxuICAgIGlmIChidWlsZGVyKSB7XHJcbiAgICAgIHJldHVybiBidWlsZGVyLnF1ZXJ5KCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gJyc7XHJcbiAgfVxyXG59XHJcbiJdfQ==