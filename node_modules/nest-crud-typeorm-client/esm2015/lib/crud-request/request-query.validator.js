import { isUndefined, isArrayStrings, isStringFull, isObject, isEqual, isNumber, isNil, objKeys, } from '../util';
import { RequestQueryException } from './exceptions';
import { CondOperator, } from './types';
export const deprecatedComparisonOperatorsList = [
    'eq',
    'ne',
    'gt',
    'lt',
    'gte',
    'lte',
    'starts',
    'ends',
    'cont',
    'excl',
    'in',
    'notin',
    'isnull',
    'notnull',
    'between',
];
const ɵ0 = (n) => CondOperator[n];
export const comparisonOperatorsList = Object.assign(deprecatedComparisonOperatorsList, objKeys(CondOperator).map(ɵ0));
export const sortOrdersList = ['ASC', 'DESC'];
const comparisonOperatorsListStr = comparisonOperatorsList.join();
const sortOrdersListStr = sortOrdersList.join();
export function validateFields(fields) {
    if (!isArrayStrings(fields)) {
        throw new RequestQueryException('Invalid fields. Array of strings expected');
    }
}
export function validateCondition(val, cond) {
    if (!isObject(val) || !isStringFull(val.field)) {
        throw new RequestQueryException(`Invalid field type in ${cond} condition. String expected`);
    }
    validateComparisonOperator(val.operator);
}
export function validateComparisonOperator(operator) {
    if (!comparisonOperatorsList.includes(operator)) {
        throw new RequestQueryException(`Invalid comparison operator. ${comparisonOperatorsListStr} expected`);
    }
}
export function validateJoin(join) {
    if (!isObject(join) || !isStringFull(join.field)) {
        throw new RequestQueryException('Invalid join field. String expected');
    }
    if (!isUndefined(join.select) && !isArrayStrings(join.select)) {
        throw new RequestQueryException('Invalid join select. Array of strings expected');
    }
}
export function validateSort(sort) {
    if (!isObject(sort) || !isStringFull(sort.field)) {
        throw new RequestQueryException('Invalid sort field. String expected');
    }
    if (!isEqual(sort.order, sortOrdersList[0]) &&
        !isEqual(sort.order, sortOrdersList[1])) {
        throw new RequestQueryException(`Invalid sort order. ${sortOrdersListStr} expected`);
    }
}
export function validateNumeric(val, num) {
    if (!isNumber(val)) {
        throw new RequestQueryException(`Invalid ${num}. Number expected`);
    }
}
export function validateParamOption(options, name) {
    if (!isObject(options)) {
        throw new RequestQueryException(`Invalid param ${name}. Invalid crud options`);
    }
    const option = options[name];
    if (option && option.disabled) {
        return;
    }
    if (!isObject(option) || isNil(option.field) || isNil(option.type)) {
        throw new RequestQueryException(`Invalid param option in Crud`);
    }
}
export function validateUUID(str, name) {
    const uuid = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
    const uuidV4 = /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
    if (!uuidV4.test(str) && !uuid.test(str)) {
        throw new RequestQueryException(`Invalid param ${name}. UUID string expected`);
    }
}
export { ɵ0 };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVxdWVzdC1xdWVyeS52YWxpZGF0b3IuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9uZXN0LWNydWQtdHlwZW9ybS1jbGllbnQvIiwic291cmNlcyI6WyJsaWIvY3J1ZC1yZXF1ZXN0L3JlcXVlc3QtcXVlcnkudmFsaWRhdG9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFDTCxXQUFXLEVBQ1gsY0FBYyxFQUNkLFlBQVksRUFDWixRQUFRLEVBQ1IsT0FBTyxFQUNQLFFBQVEsRUFDUixLQUFLLEVBQ0wsT0FBTyxHQUNSLE1BQU0sU0FBUyxDQUFDO0FBRWpCLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUVyRCxPQUFPLEVBTUwsWUFBWSxHQUNiLE1BQU0sU0FBUyxDQUFDO0FBRWpCLE1BQU0sQ0FBQyxNQUFNLGlDQUFpQyxHQUFHO0lBQy9DLElBQUk7SUFDSixJQUFJO0lBQ0osSUFBSTtJQUNKLElBQUk7SUFDSixLQUFLO0lBQ0wsS0FBSztJQUNMLFFBQVE7SUFDUixNQUFNO0lBQ04sTUFBTTtJQUNOLE1BQU07SUFDTixJQUFJO0lBQ0osT0FBTztJQUNQLFFBQVE7SUFDUixTQUFTO0lBQ1QsU0FBUztDQUNWLENBQUM7V0FHMEIsQ0FBQyxDQUFDLEVBQUUsRUFBRSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUM7QUFGbEQsTUFBTSxDQUFDLE1BQU0sdUJBQXVCLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FDbEQsaUNBQWlDLEVBQ2pDLE9BQU8sQ0FBQyxZQUFZLENBQUMsQ0FBQyxHQUFHLElBQXdCLENBQ2xELENBQUM7QUFFRixNQUFNLENBQUMsTUFBTSxjQUFjLEdBQUcsQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDLENBQUM7QUFFOUMsTUFBTSwwQkFBMEIsR0FBRyx1QkFBdUIsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUNsRSxNQUFNLGlCQUFpQixHQUFHLGNBQWMsQ0FBQyxJQUFJLEVBQUUsQ0FBQztBQUVoRCxNQUFNLFVB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TSxVQUFVLFlBQVksQ0FBQyxHQUFXLEVBQUUsSUFBWTtJQUNwRCxNQUFNLElBQUksR0FBRyxpRUFBaUUsQ0FBQztJQUMvRSxNQUFNLE1BQU0sR0FBRyxzRUFBc0UsQ0FBQztJQUN0RixJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUU7UUFDeEMsTUFBTSxJQUFJLHFCQUFxQixDQUM3QixpQkFBaUIsSUFBSSx3QkFBd0IsQ0FDOUMsQ0FBQztLQUNIO0FBQ0gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGlzVW5kZWZpbmVkLFxuICBpc0FycmF5U3RyaW5ncyxcbiAgaXNTdHJpbmdGdWxsLFxuICBpc09iamVjdCxcbiAgaXNFcXVhbCxcbiAgaXNOdW1iZXIsXG4gIGlzTmlsLFxuICBvYmpLZXlzLFxufSBmcm9tICcuLi91dGlsJztcblxuaW1wb3J0IHsgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uIH0gZnJvbSAnLi9leGNlcHRpb25zJztcbmltcG9ydCB7IFBhcmFtc09wdGlvbnMsIFBhcmFtT3B0aW9uIH0gZnJvbSAnLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7XG4gIFF1ZXJ5RmllbGRzLFxuICBRdWVyeUZpbHRlcixcbiAgQ29tcGFyaXNvbk9wZXJhdG9yLFxuICBRdWVyeUpvaW4sXG4gIFF1ZXJ5U29ydCxcbiAgQ29uZE9wZXJhdG9yLFxufSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNvbnN0IGRlcHJlY2F0ZWRDb21wYXJpc29uT3BlcmF0b3JzTGlzdCA9IFtcbiAgJ2VxJyxcbiAgJ25lJyxcbiAgJ2d0JyxcbiAgJ2x0JyxcbiAgJ2d0ZScsXG4gICdsdGUnLFxuICAnc3RhcnRzJyxcbiAgJ2VuZHMnLFxuICAnY29udCcsXG4gICdleGNsJyxcbiAgJ2luJyxcbiAgJ25vdGluJyxcbiAgJ2lzbnVsbCcsXG4gICdub3RudWxsJyxcbiAgJ2JldHdlZW4nLFxuXTtcbmV4cG9ydCBjb25zdCBjb21wYXJpc29uT3BlcmF0b3JzTGlzdCA9IE9iamVjdC5hc3NpZ24oXG4gIGRlcHJlY2F0ZWRDb21wYXJpc29uT3BlcmF0b3JzTGlzdCxcbiAgb2JqS2V5cyhDb25kT3BlcmF0b3IpLm1hcCgobikgPT4gQ29uZE9wZXJhdG9yW25dKVxuKTtcblxuZXhwb3J0IGNvbnN0IHNvcnRPcmRlcnNMaXN0ID0gWydBU0MnLCAnREVTQyddO1xuXG5jb25zdCBjb21wYXJpc29uT3BlcmF0b3JzTGlzdFN0ciA9IGNvbXBhcmlzb25PcGVyYXRvcnNMaXN0LmpvaW4oKTtcbmNvbnN0IHNvcnRPcmRlcnNMaXN0U3RyID0gc29ydE9yZGVyc0xpc3Quam9pbigpO1xuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVGaWVsZHMoZmllbGRzOiBRdWVyeUZpZWxkcyk6IHZvaWQge1xuICBpZiAoIWlzQXJyYXlTdHJpbmdzKGZpZWxkcykpIHtcbiAgICB0aHJvdyBuZXcgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uKFxuICAgICAgJ0ludmFsaWQgZmllbGRzLiBBcnJheSBvZiBzdHJpbmdzIGV4cGVjdGVkJ1xuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQ29uZGl0aW9uKFxuICB2YWw6IFF1ZXJ5RmlsdGVyLFxuICBjb25kOiAnZmlsdGVyJyB8ICdvcicgfCAnc2VhcmNoJ1xuKTogdm9pZCB7XG4gIGlmICghaXNPYmplY3QodmFsKSB8fCAhaXNTdHJpbmdGdWxsKHZhbC5maWVsZCkpIHtcbiAgICB0aHJvdyBuZXcgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uKFxuICAgICAgYEludmFsaWQgZmllbGQgdHlwZSBpbiAke2NvbmR9IGNvbmRpdGlvbi4gU3RyaW5nIGV4cGVjdGVkYFxuICAgICk7XG4gIH1cbiAgdmFsaWRhdGVDb21wYXJpc29uT3BlcmF0b3IodmFsLm9wZXJhdG9yKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQ29tcGFyaXNvbk9wZXJhdG9yKG9wZXJhdG9yOiBDb21wYXJpc29uT3BlcmF0b3IpOiB2b2lkIHtcbiAgaWYgKCFjb21wYXJpc29uT3BlcmF0b3JzTGlzdC5pbmNsdWRlcyhvcGVyYXRvcikpIHtcbiAgICB0aHJvdyBuZXcgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uKFxuICAgICAgYEludmFsaWQgY29tcGFyaXNvbiBvcGVyYXRvci4gJHtjb21wYXJpc29uT3BlcmF0b3JzTGlzdFN0cn0gZXhwZWN0ZWRgXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVKb2luKGpvaW46IFF1ZXJ5Sm9pbik6IHZvaWQge1xuICBpZiAoIWlzT2JqZWN0KGpvaW4pIHx8ICFpc1N0cmluZ0Z1bGwoam9pbi5maWVsZCkpIHtcbiAgICB0aHJvdyBuZXcgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uKCdJbnZhbGlkIGpvaW4gZmllbGQuIFN0cmluZyBleHBlY3RlZCcpO1xuICB9XG4gIGlmICghaXNVbmRlZmluZWQoam9pbi5zZWxlY3QpICYmICFpc0FycmF5U3RyaW5ncyhqb2luLnNlbGVjdCkpIHtcbiAgICB0aHJvdyBuZXcgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uKFxuICAgICAgJ0ludmFsaWQgam9pbiBzZWxlY3QuIEFycmF5IG9mIHN0cmluZ3MgZXhwZWN0ZWQnXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVTb3J0KHNvcnQ6IFF1ZXJ5U29ydCk6IHZvaWQge1xuICBpZiAoIWlzT2JqZWN0KHNvcnQpIHx8ICFpc1N0cmluZ0Z1bGwoc29ydC5maWVsZCkpIHtcbiAgICB0aHJvdyBuZXcgUmVxdWVzdFF1ZXJ5RXhjZXB0aW9uKCdJbnZhbGlkIHNvcnQgZmllbGQuIFN0cmluZyBleHBlY3RlZCcpO1xuICB9XG4gIGlmIChcbiAgICAhaXNFcXVhbChzb3J0Lm9yZGVyLCBzb3J0T3JkZXJzTGlzdFswXSkgJiZcbiAgICAhaXNFcXVhbChzb3J0Lm9yZGVyLCBzb3J0T3JkZXJzTGlzdFsxXSlcbiAgKSB7XG4gICAgdGhyb3cgbmV3IFJlcXVlc3RRdWVyeUV4Y2VwdGlvbihcbiAgICAgIGBJbnZhbGlkIHNvcnQgb3JkZXIuICR7c29ydE9yZGVyc0xpc3RTdHJ9IGV4cGVjdGVkYFxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlTnVtZXJpYyhcbiAgdmFsOiBudW1iZXIsXG4gIG51bTogJ2xpbWl0JyB8ICdvZmZzZXQnIHwgJ3BhZ2UnIHwgJ2NhY2hlJyB8IHN0cmluZ1xuKTogdm9pZCB7XG4gIGlmICghaXNOdW1iZXIodmFsKSkge1xuICAgIHRocm93IG5ldyBSZXF1ZXN0UXVlcnlFeGNlcHRpb24oYEludmFsaWQgJHtudW19LiBOdW1iZXIgZXhwZWN0ZWRgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVQYXJhbU9wdGlvbihvcHRpb25zOiBQYXJhbXNPcHRpb25zLCBuYW1lOiBzdHJpbmcpIHtcbiAgaWYgKCFpc09iamVjdChvcHRpb25zKSkge1xuICAgIHRocm93IG5ldyBSZXF1ZXN0UXVlcnlFeGNlcHRpb24oXG4gICAgICBgSW52YWxpZCBwYXJhbSAke25hbWV9LiBJbnZhbGlkIGNydWQgb3B0aW9uc2BcbiAgICApO1xuICB9XG4gIGNvbnN0IG9wdGlvbiA9IG9wdGlvbnNbbmFtZV07XG4gIGlmIChvcHRpb24gJiYgb3B0aW9uLmRpc2FibGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmICghaXNPYmplY3Qob3B0aW9uKSB8fCBpc05pbChvcHRpb24uZmllbGQpIHx8IGlzTmlsKG9wdGlvbi50eXBlKSkge1xuICAgIHRocm93IG5ldyBSZXF1ZXN0UXVlcnlFeGNlcHRpb24oYEludmFsaWQgcGFyYW0gb3B0aW9uIGluIENydWRgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVVVUlEKHN0cjogc3RyaW5nLCBuYW1lOiBzdHJpbmcpIHtcbiAgY29uc3QgdXVpZCA9IC9eWzAtOWEtZl17OH0tWzAtOWEtZl17NH0tWzAtOWEtZl17NH0tWzAtOWEtZl17NH0tWzAtOWEtZl17MTJ9JC9pO1xuICBjb25zdCB1dWlkVjQgPSAvXlswLTlhLWZdezh9LVswLTlhLWZdezR9LVsxLTVdWzAtOWEtZl17M30tWzAtOWEtZl17NH0tWzAtOWEtZl17MTJ9JC9pO1xuICBpZiAoIXV1aWRWNC50ZXN0KHN0cikgJiYgIXV1aWQudGVzdChzdHIpKSB7XG4gICAgdGhyb3cgbmV3IFJlcXVlc3RRdWVyeUV4Y2VwdGlvbihcbiAgICAgIGBJbnZhbGlkIHBhcmFtICR7bmFtZX0uIFVVSUQgc3RyaW5nIGV4cGVjdGVkYFxuICAgICk7XG4gIH1cbn1cbiJdfQ==